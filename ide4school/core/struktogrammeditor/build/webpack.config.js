const{CleanWebpackPlugin}=require("clean-webpack-plugin"),HtmlWebpackPlugin=require("html-webpack-plugin"),MiniCssExtractPlugin=require("mini-css-extract-plugin"),WebpackShellPluginNext=require("webpack-shell-plugin-next"),CopyPlugin=require("copy-webpack-plugin"),gameRoot=process.cwd(),Webpack=require("webpack"),commitHash=require("child_process").execSync("git describe --tags").toString().trim(),pathsToClean=["build"],cleanOptions={verbose:!0,dry:!1},config={entry:`${gameRoot}/src/index.js`,output:{path:`${gameRoot}/build`,filename:"struktogramm.js"},resolve:{symlinks:!1},module:{rules:[{test:/\.js$/,exclude:["/node_modules/","/build_tools/"],use:{loader:"babel-loader"}},{test:/\.scss$/,use:[MiniCssExtractPlugin.loader,{loader:"css-loader",options:{}},"sass-loader"]},{test:/\.svg$/,use:{loader:"svg-url-loader",options:{}}}]},plugins:[new Webpack.DefinePlugin({__COMMIT_HASH__:JSON.stringify(commitHash)}),new WebpackShellPluginNext({onBuildStart:{scripts:["node ./build_tools/prepareSvg.js"],blocking:!0,parallel:!1}}),new CleanWebpackPlugin({pathsToClean,cleanOptions}),new MiniCssExtractPlugin({filename:"struktogramm.css",chunkFilename:"[name].css"}),new HtmlWebpackPlugin({title:"Struktog.",template:"./src/index.html",meta:{viewport:"width=device-width, initial-scale=1, user-scalable=no","msapplication-TileColor":"#2d89ef","theme-color":"#ffffff"}}),new CopyPlugin({patterns:[{from:"*",to:"./build/"},"./src/assets/examples/"],options:{concurrency:100}})],devServer:{port:8081,contentBase:"./src",watchOptions:{poll:!0},open:!0}};module.exports=(e,l)=>(l&&l.mode||(config.mode="development"),l&&l.mode&&"development"!==l.mode||(config.devtool="source-map"),config);