(()=>{var e={31:(e,t,n)=>{const o=n(655);o.keys().forEach(o)},819:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"android-chrome-192x192.png"},505:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"android-chrome-512x512.png"},589:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"apple-touch-icon.png"},654:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"browserconfig.xml"},360:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"favicon-16x16.png"},923:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"favicon-32x32.png"},708:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"favicon.ico"},689:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"mstile-150x150.png"},307:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"safari-pinned-tab.svg"},350:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o=n.p+"site.webmanifest"},655:(e,t,n)=>{var o={"./android-chrome-192x192.png":819,"./android-chrome-512x512.png":505,"./apple-touch-icon.png":589,"./browserconfig.xml":654,"./favicon-16x16.png":360,"./favicon-32x32.png":923,"./favicon.ico":708,"./mstile-150x150.png":689,"./safari-pinned-tab.svg":307,"./site.webmanifest":350};function s(e){var t=d(e);return n(t)}function d(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}s.keys=function(){return Object.keys(o)},s.resolve=d,e.exports=s,s.id=655}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var d=t[o]={exports:{}};return e[o](d,d.exports,n),d.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");o.length&&(e=o[o.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{"use strict";n(31);const e=new class{constructor(){this.data={InsertNode:{color:"rgb(255,255,243)"},Placeholder:{color:"rgb(255,255,243)"},InsertCase:{color:"rgb(250, 218, 209)"},InputNode:{use:!0,id:"InputButton",text:"Eingabe-Feld",icon:"taskIcon",color:"rgb(253, 237, 206)"},OutputNode:{use:!0,id:"OutputButton",text:"Ausgabe-Feld",icon:"taskIcon",color:"rgb(253, 237, 206)"},TaskNode:{use:!0,id:"TaskButton",text:"Anweisung",icon:"taskIcon",color:"rgb(253, 237, 206)"},CountLoopNode:{use:!0,id:"CountLoopButton",text:"Zählergesteuerte Schleife",icon:"countLoopIcon",color:"rgb(220, 239, 231)"},HeadLoopNode:{use:!0,id:"HeadLoopButton",text:"Kopfgesteuerte Schleife",icon:"countLoopIcon",color:"rgb(220, 239, 231)"},FootLoopNode:{use:!0,id:"FootLoopButton",text:"Fußgesteuerte Schleife",icon:"footLoopIcon",color:"rgb(220, 239, 231)"},BranchNode:{use:!0,id:"BranchButton",text:"Verzweigung",icon:"branchIcon",color:"rgb(250, 218, 209)"},CaseNode:{use:!0,id:"CaseButton",text:"Fallunterscheidung",icon:"caseIcon",color:"rgb(250, 218, 209)"},FunctionNode:{use:!0,id:"FunctionButton",text:"Funktionsblock",icon:"funcIcon",color:"rgb(255, 255, 255)"},TryCatchNode:{use:!0,id:"TryCatchButton",text:"Try-Catch-Block",icon:"tryCatchIcon",color:"rgb(250, 218, 209)"}},this.alternatives={python:{InsertNode:{color:"rgb(255,255,243)"},Placeholder:{color:"rgb(255,255,243)"},InsertCase:{color:"rgb(250, 218, 209)"},InputNode:{use:!0,id:"InputButton",text:"Eingabe-Feld",icon:"taskIcon",color:"rgb(253, 237, 206)"},OutputNode:{use:!0,id:"OutputButton",text:"Ausgabe-Feld",icon:"taskIcon",color:"rgb(253, 237, 206)"},TaskNode:{use:!0,id:"TaskButton",text:"Anweisung",icon:"taskIcon",color:"rgb(253, 237, 206)"},CountLoopNode:{use:!1,id:"CountLoopButton",text:"Zählergesteuerte Schleife",icon:"countLoopIcon",color:"rgb(220, 239, 231)"},HeadLoopNode:{use:!0,id:"HeadLoopButton",text:"Schleife",icon:"countLoopIcon",color:"rgb(220, 239, 231)"},FootLoopNode:{use:!1,id:"FootLoopButton",text:"Fußgesteuerte Schleife",icon:"footLoopIcon",color:"rgb(220, 239, 231)"},BranchNode:{use:!0,id:"BranchButton",text:"Verzweigung",icon:"branchIcon",color:"rgb(250, 218, 209)"},CaseNode:{use:!0,id:"CaseButton",text:"Fallunterscheidung",icon:"caseIcon",color:"rgb(250, 218, 209)"},FunctionNode:{use:!1,id:"FunctionButton",text:"Funktionsblock",icon:"funcIcon",color:"rgb(255, 255, 255)"},TryCatchNode:{use:!0,id:"TryCatchButton",text:"Try-Catch-Block",icon:"tryCatchIcon",color:"rgb(250, 218, 209)"}},python_func:{InsertNode:{color:"rgb(255,255,243)"},Placeholder:{color:"rgb(255,255,243)"},InsertCase:{color:"rgb(250, 218, 209)"},InputNode:{use:!0,id:"InputButton",text:"Eingabe-Feld",icon:"taskIcon",color:"rgb(253, 237, 206)"},OutputNode:{use:!0,id:"OutputButton",text:"Ausgabe-Feld",icon:"taskIcon",color:"rgb(253, 237, 206)"},TaskNode:{use:!0,id:"TaskButton",text:"Anweisung",icon:"taskIcon",color:"rgb(253, 237, 206)"},CountLoopNode:{use:!0,id:"CountLoopButton",text:"Zählergesteuerte Schleife",icon:"countLoopIcon",color:"rgb(220, 239, 231)"},HeadLoopNode:{use:!0,id:"HeadLoopButton",text:"Kopfgesteuerte Schleife",icon:"countLoopIcon",color:"rgb(220, 239, 231)"},FootLoopNode:{use:!0,id:"FootLoopButton",text:"Fußgesteuerte Schleife",icon:"footLoopIcon",color:"rgb(220, 239, 231)"},BranchNode:{use:!0,id:"BranchButton",text:"Verzweigung",icon:"branchIcon",color:"rgb(250, 218, 209)"},CaseNode:{use:!0,id:"CaseButton",text:"Fallunterscheidung",icon:"caseIcon",color:"rgb(250, 218, 209)"},FunctionNode:{use:!0,id:"FunctionButton",text:"Funktionsblock",icon:"funcIcon",color:"rgb(255, 255, 255)"},TryCatchNode:{use:!0,id:"TryCatchButton",text:"Try-Catch-Block",icon:"tryCatchIcon",color:"rgb(250, 218, 209)"}},standard:{InsertNode:{color:"rgb(255,255,243)"},Placeholder:{color:"rgb(255,255,243)"},InsertCase:{color:"rgb(250, 218, 209)"},InputNode:{use:!0,id:"InputButton",text:"Eingabe-Feld",icon:"taskIcon",color:"rgb(253, 237, 206)"},OutputNode:{use:!0,id:"OutputButton",text:"Ausgabe-Feld",icon:"taskIcon",color:"rgb(253, 237, 206)"},TaskNode:{use:!0,id:"TaskButton",text:"Anweisung",icon:"taskIcon",color:"rgb(253, 237, 206)"},CountLoopNode:{use:!0,id:"CountLoopButton",text:"Zählergesteuerte Schleife",icon:"countLoopIcon",color:"rgb(220, 239, 231)"},HeadLoopNode:{use:!0,id:"HeadLoopButton",text:"Kopfgesteuerte Schleife",icon:"countLoopIcon",color:"rgb(220, 239, 231)"},FootLoopNode:{use:!0,id:"FootLoopButton",text:"Fußgesteuerte Schleife",icon:"footLoopIcon",color:"rgb(220, 239, 231)"},BranchNode:{use:!0,id:"BranchButton",text:"Verzweigung",icon:"branchIcon",color:"rgb(250, 218, 209)"},CaseNode:{use:!0,id:"CaseButton",text:"Fallunterscheidung",icon:"caseIcon",color:"rgb(250, 218, 209)"},FunctionNode:{use:!1,id:"FunctionButton",text:"Funktionsblock",icon:"funcIcon",color:"rgb(255, 255, 255)"},TryCatchNode:{use:!1,id:"TryCatchButton",text:"Try-Catch-Block",icon:"tryCatchIcon",color:"rgb(250, 218, 209)"}}}}get(){return this.data}loadConfig(e){e in this.alternatives&&(this.data=this.alternatives[e])}};function t(){const e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()}const o=new class{constructor(e={id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}){this.tree=e,this.presenter=null,"undefined"!=typeof Storage&&"tree"in localStorage&&this.setTree(JSON.parse(localStorage.tree))}setPresenter(e){this.presenter=e}getTree(){return this.tree}setTree(e){this.tree=e}reset(){this.tree={id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}}findAndAlterElement(e,t,n,o,s){if(null===t||"Placeholder"===t.type)return t;if(t.id===e)return t=(n=n.bind(this))(t,o,s),null===this.presenter.getMoveId()&&this.presenter.resetButtons(),t;switch(t.type){case"InsertNode":case"InsertCase":return t.followElement=this.findAndAlterElement(e,t.followElement,n,o,s),t;case"InputNode":case"OutputNode":case"TaskNode":return t.followElement=this.findAndAlterElement(e,t.followElement,n,!0,s),t;case"HeadLoopNode":case"FootLoopNode":case"CountLoopNode":case"FunctionNode":return t.child=this.findAndAlterElement(e,t.child,n,!1,s),t.followElement=this.findAndAlterElement(e,t.followElement,n,!0,s),t;case"BranchNode":return t.trueChild=this.findAndAlterElement(e,t.trueChild,n,!1,s),t.falseChild=this.findAndAlterElement(e,t.falseChild,n,!1,s),t.followElement=this.findAndAlterElement(e,t.followElement,n,!0,s),t;case"TryCatchNode":return t.tryChild=this.findAndAlterElement(e,t.tryChild,n,!1,s),t.catchChild=this.findAndAlterElement(e,t.catchChild,n,!1,s),t.followElement=this.findAndAlterElement(e,t.followElement,n,!0,s),t;case"CaseNode":{const o=[];for(const d of t.cases){const t=this.findAndAlterElement(e,d,n,!1,s);null!==t&&o.push(t)}o.length>=2&&(t.cases=o);const d=this.findAndAlterElement(e,t.defaultNode,n,!1,s);return null===d?t.defaultOn=!1:t.defaultNode=d,t.followElement=this.findAndAlterElement(e,t.followElement,n,!0,s),t}}}removeNode(e,t,n){return"InsertCase"===e.type?null:null!==e.followElement.followElement||t?e.followElement.followElement:{type:"Placeholder"}}editElement(e,t,n){if("FunctionNode"===e.type){const t=n.split("|");if("funcname"===t[0])e.text=t[1];else{if(0!==e.parameters.length){let n=0;for(const o of e.parameters){if(t[0]===o.pos)return e.parameters[n].parName=t[1],e;n+=1}}e.parameters.push({pos:t[0],parName:t[1]})}}else e.text=n;return e}insertElement(e,t,n){const o=this.presenter.getNextInsertElement();return null!==e.followElement&&"Placeholder"!==e.followElement.type&&(o.followElement.followElement=e.followElement),e.followElement=o,e}switchDefaultCase(e,t,n){return e.defaultOn?e.defaultOn=!1:e.defaultOn=!0,e}insertNewCase(e,n,o){return e.cases.length<7&&e.cases.push({id:t(),type:"InsertCase",text:"Fall",followElement:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}}),e}getElementInTree(e,t){if(null===t||"Placeholder"===t.type)return null;if(t.id===e)return JSON.parse(JSON.stringify(t));switch(t.type){case"InsertNode":case"InputNode":case"OutputNode":case"TaskNode":case"InsertCase":return this.getElementInTree(e,t.followElement);case"HeadLoopNode":case"CountLoopNode":case"FootLoopNode":case"FunctionNode":{const n=this.getElementInTree(e,t.child);return null===n?this.getElementInTree(e,t.followElement):n}case"BranchNode":{let n=this.getElementInTree(e,t.trueChild);return null===n?(n=this.getElementInTree(e,t.falseChild),null===n?this.getElementInTree(e,t.followElement):n):n}case"TryCatchNode":{let n=this.getElementInTree(e,t.tryChild);return null===n?(n=this.getElementInTree(e,t.catchChild),null===n?this.getElementInTree(e,t.followElement):n):n}case"CaseNode":{let n=null;for(const o of t.cases){const t=this.getElementInTree(e,o);null!=t&&(n=t)}return null===n?(n=this.getElementInTree(e,t.defaultNode),null===n?this.getElementInTree(e,t.followElement):n):n}}}};class s{constructor(e){this.model=e,this.insertMode=!1,this.settingFunctionMode=!1,this.views=[],this.moveId=null,this.nextInsertElement=null,this.displaySourcecode=!1,this.undoList=[],this.redoList=[]}addView(e){this.views.push(e)}getInsertMode(){return this.insertMode}getSettingFunctionMode(){return this.settingFunctionMode}getModelTree(){return this.model.getTree()}getElementByUid(e){return this.model.getElementInTree(e,this.model.getTree())}resetButtons(){for(const e of this.views)e.resetButtons()}reset(){this.insertMode=!1,this.settingFunctionMode=!1,this.nextInsertElement=null,this.moveId=null}setSourcecodeDisplay(e){this.displaySourcecode=e}getSourcecodeDisplay(){return this.displaySourcecode}updateBrowserStore(){"undefined"!=typeof Storage&&(localStorage.tree=JSON.stringify(this.model.getTree()),localStorage.displaySourcecode=this.displaySourcecode)}getMoveId(){return this.moveId}getNextInsertElement(){return this.nextInsertElement}renderAllViews(){for(const e of this.views)e.render(this.model.getTree())}init(){this.renderAllViews()}startTransforming(e){for(const t of this.views)t.setLang(e.target.value);this.renderAllViews()}alterSourcecodeDisplay(e){this.displaySourcecode?this.displaySourcecode=!1:this.displaySourcecode=!0,this.updateBrowserStore();for(const e of this.views)e.displaySourcecode("ToggleSourcecode")}insertNode(e,n){switch(e){case"InputButton":this.nextInsertElement={id:t(),type:"InputNode",text:"",followElement:{id:t(),type:"InsertNode",followElement:null}};break;case"OutputButton":this.nextInsertElement={id:t(),type:"OutputNode",text:"",followElement:{id:t(),type:"InsertNode",followElement:null}};break;case"TaskButton":this.nextInsertElement={id:t(),type:"TaskNode",text:"Anweisung",followElement:{id:t(),type:"InsertNode",followElement:null}};break;case"BranchButton":this.nextInsertElement={id:t(),type:"BranchNode",text:"Bedingung",followElement:{id:t(),type:"InsertNode",followElement:null},trueChild:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}},falseChild:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}};break;case"CaseButton":this.nextInsertElement={id:t(),type:"CaseNode",text:"Variable",followElement:{id:t(),type:"InsertNode",followElement:null},defaultOn:!0,defaultNode:{id:t(),type:"InsertCase",text:"Sonst",followElement:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}},cases:[{id:t(),type:"InsertCase",text:"Fall",followElement:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}},{id:t(),type:"InsertCase",text:"Fall",followElement:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}}]};break;case"CountLoopButton":this.nextInsertElement={id:t(),type:"CountLoopNode",text:"Zählbedingung",followElement:{id:t(),type:"InsertNode",followElement:null},child:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}};break;case"HeadLoopButton":this.nextInsertElement={id:t(),type:"HeadLoopNode",text:"Gültigkeitsbedingung",followElement:{id:t(),type:"InsertNode",followElement:null},child:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}};break;case"FunctionButton":this.nextInsertElement={id:t(),type:"FunctionNode",text:"",parameters:[],followElement:{id:t(),type:"InsertNode",followElement:null},child:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}},this.settingFunctionMode=!0;break;case"FootLoopButton":this.nextInsertElement={id:t(),type:"FootLoopNode",text:"Gültigkeitsbedingung",followElement:{id:t(),type:"InsertNode",followElement:null},child:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}};break;case"TryCatchButton":this.nextInsertElement={id:t(),type:"TryCatchNode",text:"",followElement:{id:t(),type:"InsertNode",followElement:null},tryChild:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}},catchChild:{id:t(),type:"InsertNode",followElement:{type:"Placeholder"}}}}void 0!==n.dataTransfer&&(n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text",e));const o=document.getElementById(e);o.classList.contains("boldText")?(this.resetButtons(),this.reset()):(this.resetButtons(),this.insertMode=!0,o.classList.add("boldText")),this.renderAllViews()}resetDrop(){this.insertMode?(this.reset(),this.resetButtons(),this.renderAllViews()):this.resetButtons()}resetModel(){this.updateUndo(),this.model.reset(),this.checkUndo(),this.updateBrowserStore(),this.renderAllViews(),document.getElementById("IEModal").classList.remove("active")}switchDefaultState(e){this.updateUndo(),this.model.setTree(this.model.findAndAlterElement(e,this.model.getTree(),this.model.switchDefaultCase,!1,"")),this.checkUndo(),this.updateBrowserStore(),this.renderAllViews()}addCase(e){this.updateUndo(),this.model.setTree(this.model.findAndAlterElement(e,this.model.getTree(),this.model.insertNewCase,!1,"")),this.checkUndo(),this.updateBrowserStore(),this.renderAllViews()}removeElement(e){const t=this.model.getElementInTree(e,this.model.getTree());switch(t.type){case"TaskNode":case"InputNode":case"OutputNode":this.removeNodeFromTree(e);break;case"HeadLoopNode":case"CountLoopNode":case"FootLoopNode":case"FunctionNode":"Placeholder"!==t.child.followElement.type?this.prepareRemoveQuestion(e):this.removeNodeFromTree(e);break;case"BranchNode":"Placeholder"!==t.trueChild.followElement.type||"Placeholder"!==t.falseChild.followElement.type?this.prepareRemoveQuestion(e):this.removeNodeFromTree(e);break;case"TryCatchNode":"Placeholder"!==t.tryChild.followElement.type||"Placeholder"!==t.catchChild.followElement.type?this.prepareRemoveQuestion(e):this.removeNodeFromTree(e);break;case"CaseNode":{let n=!1;for(const e of t.cases)"Placeholder"!==e.followElement.followElement.type&&(n=!0);"Placeholder"!==t.defaultNode.followElement.followElement.type&&(n=!0),n?this.prepareRemoveQuestion(e):this.removeNodeFromTree(e);break}case"InsertCase":"Placeholder"!==t.followElement.followElement.type?this.prepareRemoveQuestion(e):this.removeNodeFromTree(e)}}prepareRemoveQuestion(e){const t=document.getElementById("modal-content"),n=document.getElementById("modal-footer");for(;t.hasChildNodes();)t.removeChild(t.lastChild);for(;n.hasChildNodes();)n.removeChild(n.lastChild);t.appendChild(document.createTextNode("Dieses Element und alle darin erstellten Blöcke löschen?"));const o=document.createElement("div");o.classList.add("modal-buttons","acceptIcon","hand"),o.addEventListener("click",(()=>this.removeNodeFromTree(e,!0))),n.appendChild(o);const s=document.createElement("div");s.classList.add("modal-buttons","deleteIcon","hand"),s.addEventListener("click",(()=>document.getElementById("IEModal").classList.remove("active"))),n.appendChild(s),document.getElementById("IEModal").classList.add("active")}removeNodeFromTree(e,t=!1){this.updateUndo(),this.model.setTree(this.model.findAndAlterElement(e,this.model.getTree(),this.model.removeNode,!1,"")),this.checkUndo(),this.updateBrowserStore(),this.renderAllViews(),t&&document.getElementById("IEModal").classList.remove("active")}removeParamFromParameters(e){let t=this.model.getTree();const n=[];for(;"FunctionNode"!==t.type;)n.push(t),t=t.followElement;const o=t.parameters;for(const s of o){const d=parseInt(s.pos);if(d===e){let e=d/3;for(o.splice(e,1);e<o.length;)o[e].pos-=3,e+=1;t.parameters=o;let s=n.length-1;for(;s>-1;){const e=n[s];e.followElement=t,t=e,s-=1}return this.model.setTree(t),this.updateBrowserStore(),void this.renderAllViews()}}}moveElement(e){this.moveId=e,this.insertMode=!0,this.nextInsertElement=this.model.getElementInTree(e,this.model.getTree()),this.nextInsertElement.followElement.followElement=null,this.renderAllViews()}editElement(e,t,n=""){this.updateUndo(),this.model.setTree(this.model.findAndAlterElement(e,this.model.getTree(),this.model.editElement,!1,n+t)),this.checkUndo(),this.updateBrowserStore(),this.renderAllViews()}appendElement(e){this.updateUndo();const t=this.moveId;t&&this.model.setTree(this.model.findAndAlterElement(this.moveId,this.model.getTree(),this.model.removeNode,!1,""));const n=this.nextInsertElement.id;this.model.setTree(this.model.findAndAlterElement(e,this.model.getTree(),this.model.insertElement,!1,"")),t&&this.resetButtons(),this.reset(),this.checkUndo(),this.updateBrowserStore(),this.renderAllViews(),t||"TryCatchNode"===this.getElementByUid(n).type||this.switchEditState(n)}switchEditState(e,t=null){let n=document.getElementById(e);if(n.children[0].children[0].classList.contains("func-box-header")){let e=null;e=null===t?n.children[0].children[0].children[1].children[0]:n.children[0].children[0].children[2].children[t].children[0],e&&e.click()}else n=n.getElementsByClassName("input-group editField "+e).length?n.childNodes[0].classList.contains("tryCatchNode")?n.getElementsByClassName("input-group editField "+e)[1]:n.getElementsByClassName("input-group editField "+e)[0]:n.children[0].classList.contains("tryCatchNode")?n.getElementsByClassName("tryCatchNode")[1].children[1].children[1]:n.getElementsByClassName("input-group editField")[0],n.previousSibling.style.display="none",n.style.display="inline-flex",n.getElementsByTagName("input")[0].select()}getStringifiedTree(){return JSON.stringify(this.model.getTree())}saveDialog(){const e="data:application/json;charset=utf-8,"+encodeURIComponent(this.getStringifiedTree()),t="struktog_"+new Date(Date.now()).toJSON().substring(0,10)+".json",n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),n.click()}readFile(e){const t=new FileReader;t.onload=e=>{const t=JSON.parse(e.target.result);this.updateUndo(),this.model.setTree(t),this.checkUndo(),this.renderAllViews(),this.updateBrowserStore(),console.log(e)},t.readAsText(e.target.files[0])}readUrl(e){this.updateUndo(),this.model.setTree(e),this.checkUndo(),this.renderAllViews(),this.updateBrowserStore()}updateUndo(){this.undoList.push(this.getStringifiedTree());for(const e of document.getElementsByClassName("UndoIconButtonOverlay"))e.classList.remove("disableIcon");this.redoList=[];for(const e of document.getElementsByClassName("RedoIconButtonOverlay"))e.classList.add("disableIcon")}undo(){if(this.undoList.length){if(this.redoList.unshift(this.getStringifiedTree()),this.model.setTree(JSON.parse(this.undoList[this.undoList.length-1])),this.undoList.pop(),0===this.undoList)for(const e of document.getElementsByClassName("UndoIconButtonOverlay"))e.classList.add("disableIcon");for(const e of document.getElementsByClassName("RedoIconButtonOverlay"))e.classList.remove("disableIcon");this.renderAllViews(),this.updateBrowserStore()}}checkUndo(){if(this.undoList[this.undoList.length-1]===this.getStringifiedTree()&&(this.undoList.pop(),0===this.undoList))for(const e of document.getElementsByClassName("UndoIconButtonOverlay"))e.classList.add("disableIcon")}redo(){if(this.redoList.length){if(this.undoList.push(this.getStringifiedTree()),this.model.setTree(JSON.parse(this.redoList[0])),this.redoList.shift(),0===this.redoList.length)for(const e of document.getElementsByClassName("RedoIconButtonOverlay"))e.classList.add("disableIcon");for(const e of document.getElementsByClassName("UndoIconButtonOverlay"))e.classList.remove("disableIcon");this.renderAllViews(),this.updateBrowserStore()}}}function d(e,t=[],n=!1){const o=document.createElement(e);for(const e of t)o.classList.add(e);return n&&n.appendChild(o),o}class i{constructor(e,t){this.presenter=e,this.domRoot=t,this.size=7,this.buttonList=["InputNode","OutputNode","TaskNode","CountLoopNode","HeadLoopNode","FootLoopNode","BranchNode","CaseNode","TryCatchNode","FunctionNode"],this.preRender()}preRender(){const t=document.createElement("div");t.classList.add("columnEditorFull");const n=document.createElement("div"),o=document.createElement("strong");o.classList.add("margin-small"),o.appendChild(document.createTextNode("Element wählen:")),n.appendChild(o),t.appendChild(n);const s=document.createElement("div");s.classList.add("container","justify-center");for(const t of this.buttonList)e.get()[t].use&&s.appendChild(this.createButton(t));t.appendChild(s);const d=document.createElement("div");d.classList.add("columnEditorFull","headerContainer");const i=document.createElement("strong");i.classList.add("margin-small","floatBottom"),i.appendChild(document.createTextNode("Editor:")),d.appendChild(i);const a=document.createElement("div");a.id="struktoOptions1",a.classList.add("struktoOptions1"),d.appendChild(a),this.createStrukOptions(a);const l=document.createElement("div");l.classList.add("vcontainer","columnEditorStructogram"),l.id="editorContent";const r=document.createElement("div");r.classList.add("columnAuto","container");const c=document.createElement("div");c.classList.add("columnAuto-6");const p=document.createElement("div");p.classList.add("borderWidth","frameLeft");const h=document.createElement("div");h.classList.add("columnAuto"),h.id="structogram",l.appendChild(r),r.appendChild(h),r.appendChild(p),l.appendChild(c);const u=document.createElement("div");u.classList.add("columnEditorOptions","columnFull"),this.domRoot.appendChild(t),this.domRoot.appendChild(u),this.domRoot.appendChild(d),this.domRoot.appendChild(l);const m=document.createElement("div");m.classList.add("columnEditorCode","container"),this.domRoot.appendChild(m);const f=document.createElement("div");f.id="struktoOptions2",f.classList.add("struktoOptions2"),u.appendChild(f),this.createStrukOptions(f);const C=document.createElement("div");C.id="SourcecodeDisplay",C.classList.add("fullWidth","fullHeight","vcontainer"),C.style.display="none",m.appendChild(C),this.domRoot=document.getElementById("structogram")}createStrukOptions(e){this.generateUndoRedoButtons(this.presenter,e),function(e,t){const n=document.createElement("div");n.classList.add("struktoOption","resetIcon","tooltip","tooltip-bottom","hand"),n.setAttribute("data-tooltip","Reset"),n.addEventListener("click",(()=>{const t=document.getElementById("modal-content"),n=document.getElementById("modal-footer");for(;t.hasChildNodes();)t.removeChild(t.lastChild);for(;n.hasChildNodes();)n.removeChild(n.lastChild);t.appendChild(document.createTextNode("Alles löschen?"));const o=document.createElement("div");o.classList.add("modal-buttons","acceptIcon","hand"),o.addEventListener("click",(()=>e.resetModel())),n.appendChild(o);const s=document.createElement("div");s.classList.add("modal-buttons","deleteIcon","hand"),s.addEventListener("click",(()=>document.getElementById("IEModal").classList.remove("active"))),n.appendChild(s),document.getElementById("IEModal").classList.add("active")})),t.appendChild(n)}(this.presenter,e)}generateUndoRedoButtons(e,t){const n=document.createElement("div");n.classList.add("struktoOption","undoIcon","tooltip","tooltip-bottom","hand"),n.setAttribute("data-tooltip","Undo"),t.appendChild(n);const o=document.createElement("div");o.classList.add("fullWidth","fullHeight","UndoIconButtonOverlay","disableIcon"),o.addEventListener("click",(()=>e.undo())),n.appendChild(o);const s=document.createElement("div");s.classList.add("struktoOption","redoIcon","tooltip","tooltip-bottom","hand"),s.setAttribute("data-tooltip","Redo"),t.appendChild(s);const d=document.createElement("div");d.classList.add("fullWidth","fullHeight","RedoIconButtonOverlay","disableIcon"),d.addEventListener("click",(()=>e.redo())),s.appendChild(d)}createButton(t){const n=document.createElement("div");n.classList.add("columnInput","insertButton","hand"),n.style.backgroundColor=e.get()[t].color,n.id=e.get()[t].id,n.draggable="true",n.addEventListener("click",(n=>this.presenter.insertNode(e.get()[t].id,n))),n.addEventListener("dragstart",(n=>this.presenter.insertNode(e.get()[t].id,n))),n.addEventListener("dragend",(()=>this.presenter.resetDrop()));const o=document.createElement("span");o.appendChild(document.createTextNode(e.get()[t].text));const s=document.createElement("div");return s.classList.add(e.get()[t].icon,"buttonLogo"),n.append(s),n.append(o),n}render(e){for(;this.domRoot.hasChildNodes();)this.domRoot.removeChild(this.domRoot.lastChild);for(const t of this.renderElement(e,!1,!1,this.presenter.getSettingFunctionMode()))this.applyCodeEventListeners(t),this.domRoot.appendChild(t);const t=document.createElement("div");t.classList.add("frameTop","borderHeight"),this.domRoot.appendChild(t)}createFunctionHeaderTextEl(e,t,n,o,s,i=null){const a=document.createElement("span");a.classList.add("func-header-text-div"),null===i||""===i?a.appendChild(document.createTextNode(o)):a.appendChild(document.createTextNode(i));const l=document.createElement("div");if(l.classList.add("function-elem"),l.style.display="flex",l.style.flexDirection="row",l.appendChild(a),!e.classList.contains("func-box-header")){const e=document.createElement("button");e.classList.add("trashcan","optionIcon","hand","tooltip","tooltip-bottoml"),e.style.minWidth="1.2em",e.style.border="none",e.setAttribute("data-tooltip","Entfernen"),e.addEventListener("click",(()=>{this.presenter.removeParamFromParameters(t)})),a.addEventListener("mouseover",(()=>{a.parentElement.appendChild(e)})),a.parentElement.addEventListener("mouseleave",(()=>{e.remove()}))}return a.addEventListener("click",(()=>{l.remove();const a=document.createElement("div");a.style.display="flex",a.style.flexDirection="row";const r=d("input",["function-elem","func-header-input"],a);r.contentEditable=!0,r.style.border="solid 1px black",r.style.margin="0 0 0 0",r.style.width=n+"ch",r.size=n,r.type="text",r.placeholder=o,r.value=i;const c=()=>{const n=document.createElement("div");n.classList.add("function-elem");const o=d("span",["func-header-text-div"],n);o.appendChild(document.createTextNode(r.value)),o.addEventListener("click",(()=>{n.remove(),e.insertBefore(a,e.childNodes[t])})),r.remove(),e.insertBefore(n,e.childNodes[t])},p=d("div",["acceptIcon","hand"],a);p.style.minWidth="1.4em",p.style.marginLeft="0.2em",p.addEventListener("click",(()=>{e.classList.contains("func-box-header")?this.presenter.editElement(s,r.value,"funcname|"):this.presenter.editElement(s,r.value,String(t)+"|"),this.presenter.renderAllViews(),c()}));const h=d("div",["deleteIcon","hand"],a);h.style.minWidth="1.4em",h.style.marginLeft="0.2em",h.addEventListener("click",(()=>this.presenter.renderAllViews())),e.insertBefore(a,e.childNodes[t]);const u=n=>{"Enter"!==n.code&&"blur"!==n.type||("Enter"===n.code&&r.removeEventListener("blur",u),e.classList.contains("func-box-header")?this.presenter.editElement(s,r.value,"funcname|"):this.presenter.editElement(s,r.value,String(t)+"|"),this.presenter.renderAllViews(),c())},m="keyup,keypress,focus,blur,change,input".split(",");for(const e of m)r.addEventListener(e,u)})),l}createSpacing(e){const t=document.createElement("div");return t.style.marginRight=e+"ch",t}renderParam(e,t,n,o,s,d=null){const i=3*e;return 0!==e&&(t.appendChild(document.createTextNode(",")),t.appendChild(this.createSpacing(n))),e+=1,t.appendChild(this.createFunctionHeaderTextEl(t,i,o,"par "+e,s,d)),d}renderFunctionBox(e,t,n){const o=document.createElement("div");o.classList.add("input-group","fixedHeight","func-box-header","padding"),o.style.display="flex",o.style.flexDirection="row",o.style.paddingTop="6.5px";const s=document.createElement("div");s.classList.add("input-group"),s.style.display="flex",s.style.flexDirection="row",s.style.flex="0 0 1ch";let d=0;for(const t of n)this.renderParam(d,s,1,5,e,t.parName),d+=1;const i=document.createElement("button");i.classList.add("addCaseIcon","hand","caseOptionsIcons","tooltip","tooltip-bottom"),i.style.marginTop="auto",i.style.marginBottom="auto",i.setAttribute("data-tooltip","Parameter hinzufügen"),i.addEventListener("click",(()=>{i.remove();const t=document.getElementsByClassName("function-elem").length-1;this.renderParam(t,s,1,5,e)})),o.addEventListener("mouseover",(()=>{s.appendChild(i)})),o.addEventListener("mouseleave",(()=>{i.remove()})),o.appendChild(document.createTextNode("function")),o.appendChild(this.createSpacing(2)),o.appendChild(this.createFunctionHeaderTextEl(o,2,15,"func name",e,t)),o.appendChild(document.createTextNode("(")),o.appendChild(s),o.appendChild(document.createTextNode(")")),o.appendChild(this.createSpacing(1)),o.appendChild(document.createTextNode("{"));const a=document.createElement("div");return a.style.marginRight="auto",o.appendChild(a),o}renderElement(t,n,o,s=!1){const i=[];if(null===t)return i;{null!==this.presenter.getMoveId()&&t.id===this.presenter.getMoveId()&&(n=!0,o=!0);const a=document.createElement("div");switch(t.id&&(a.id=t.id),a.classList.add("vcontainer","frameTopLeft","columnAuto"),a.style.backgroundColor=e.get()[t.type].color,t.type){case"InsertNode":if(n)return this.renderElement(t.followElement,!1,!1);if(o)return this.renderElement(t.followElement,!1,!0);if(this.presenter.getInsertMode()){if(this.presenter.getSettingFunctionMode()){if(s){const e=document.createElement("div");if(e.classList.add("container","fixedHalfHeight","symbol","hand","text-center"),a.addEventListener("dragover",(function(e){e.preventDefault()})),a.addEventListener("drop",(e=>{e.preventDefault(),this.presenter.appendElement(t.id)})),a.addEventListener("click",(()=>this.presenter.appendElement(t.id))),this.presenter.getMoveId()&&t.followElement&&t.followElement.id===this.presenter.getMoveId()){const t=document.createElement("strong");t.classList.add("moveText"),t.appendChild(document.createTextNode("Verschieben abbrechen")),e.appendChild(t)}else{const t=document.createElement("div");t.classList.add("insertIcon","symbolHeight"),e.appendChild(t)}return a.appendChild(e),i.push(a),null===t.followElement||"Placeholder"===t.followElement.type?i:i.concat(this.renderElement(t.followElement,!1,o))}return this.renderElement(t.followElement,!1,o)}{const e=document.createElement("div");if(e.classList.add("container","fixedHalfHeight","symbol","hand","text-center"),a.addEventListener("dragover",(function(e){e.preventDefault()})),a.addEventListener("drop",(e=>{e.preventDefault(),this.presenter.appendElement(t.id)})),a.addEventListener("click",(()=>this.presenter.appendElement(t.id))),this.presenter.getMoveId()&&t.followElement&&t.followElement.id===this.presenter.getMoveId()){const t=document.createElement("strong");t.classList.add("moveText"),t.appendChild(document.createTextNode("Verschieben abbrechen")),e.appendChild(t)}else{const t=document.createElement("div");t.classList.add("insertIcon","symbolHeight"),e.appendChild(t)}return a.appendChild(e),i.push(a),null===t.followElement||"Placeholder"===t.followElement.type?i:i.concat(this.renderElement(t.followElement,!1,o))}}return this.renderElement(t.followElement,n,o);case"Placeholder":{const e=document.createElement("div");e.classList.add("container","fixedHeight");const t=document.createElement("div");return t.classList.add("placeholder","symbolHeight","symbol"),e.appendChild(t),a.appendChild(e),i.push(a),i}case"InsertCase":{a.classList.remove("frameTopLeft","columnAuto"),a.classList.add("frameLeft","fixedHeight");const e=document.createElement("div");e.classList.add("fixedHeight","container");const s=this.createTextDiv(t.type,t.text,t.id),d=this.createOptionDiv(t.type,t.id);return e.appendChild(s),e.appendChild(d),a.appendChild(e),i.push(a),i.concat(this.renderElement(t.followElement,n,o))}case"InputNode":case"OutputNode":case"TaskNode":{const e=document.createElement("div");e.classList.add("fixedHeight","container");const s=this.createTextDiv(t.type,t.text,t.id),d=this.createOptionDiv(t.type,t.id);return e.appendChild(s),e.appendChild(d),a.appendChild(e),i.push(a),i.concat(this.renderElement(t.followElement,n,o))}case"BranchNode":{const e=document.createElement("div");e.classList.add("columnAuto","vcontainer");const s=document.createElement("div");s.classList.add("branchSplit","vcontainer","fixedDoubleHeight");const d=document.createElement("div");d.classList.add("fixedHeight","container");const l=this.createTextDiv(t.type,t.text,t.id),r=this.createOptionDiv(t.type,t.id);d.appendChild(l),d.appendChild(r);const c=document.createElement("div");c.classList.add("fixedHeight","container","padding");const p=document.createElement("div");p.classList.add("columnAuto","text-left","bottomHeader"),p.appendChild(document.createTextNode("Wahr"));const h=document.createElement("div");h.classList.add("columnAuto","text-right","bottomHeader"),h.appendChild(document.createTextNode("Falsch")),c.appendChild(p),c.appendChild(h),s.appendChild(d),s.appendChild(c),e.appendChild(s);const u=document.createElement("div");u.classList.add("columnAuto","branchCenter","container");const m=document.createElement("div");m.classList.add("columnAuto","vcontainer","ov-hidden");for(const e of this.renderElement(t.trueChild,!1,o))this.applyCodeEventListeners(e),m.appendChild(e);const f=document.createElement("div");f.classList.add("columnAuto","vcontainer","ov-hidden");for(const e of this.renderElement(t.falseChild,!1,o))this.applyCodeEventListeners(e),f.appendChild(e);return u.appendChild(m),u.appendChild(f),e.appendChild(u),a.appendChild(e),i.push(a),i.concat(this.renderElement(t.followElement,n,o))}case"TryCatchNode":{const e=d("div",["columnAuto","vcontainer","tryCatchNode"],a),s=d("div",["container","fixedHeight","padding"],e),l=this.createOptionDiv(t.type,t.id);s.appendChild(l),d("div",["symbol"],s).appendChild(document.createTextNode("Try"));const r=d("div",["columnAuto","container","loopShift"],e),c=d("div",["loopWidth","frameLeft","vcontainer"],r);for(const e of this.renderElement(t.tryChild,!1,o))this.applyCodeEventListeners(e),c.appendChild(e);const p=d("div",["container","columnAuto","loopShift"],e),h=d("div",["loopWidth","vcontainer"],p);d("div",["frameLeftBottom"],h).style.flex="0 0 3px";const u=d("div",["container","fixedHeight","padding","tryCatchNode"],e);d("div",["symbol"],u).appendChild(document.createTextNode("Catch"));const m=this.createTextDiv(t.type,t.text,t.id);u.appendChild(m);const f=d("div",["columnAuto","container","loopShift"],e),C=d("div",["loopWidth","frameLeft","vcontainer"],f);for(const e of this.renderElement(t.catchChild,!1,o))this.applyCodeEventListeners(e),C.appendChild(e);return i.push(a),i.concat(this.renderElement(t.followElement,n,o))}case"HeadLoopNode":case"CountLoopNode":{const e=document.createElement("div");e.classList.add("columnAuto","vcontainer");const s=document.createElement("div");s.classList.add("container","fixedHeight");const d=this.createTextDiv(t.type,t.text,t.id),l=this.createOptionDiv(t.type,t.id);s.appendChild(d),s.appendChild(l),e.appendChild(s);const r=document.createElement("div");r.classList.add("columnAuto","container","loopShift");const c=document.createElement("div");c.classList.add("loopWidth","frameLeft","vcontainer");for(const e of this.renderElement(t.child,!1,o))this.applyCodeEventListeners(e),c.appendChild(e);return r.appendChild(c),e.appendChild(r),a.appendChild(e),i.push(a),i.concat(this.renderElement(t.followElement,n,o))}case"FunctionNode":{const e=document.createElement("div");e.classList.add("columnAuto","vcontainer");const s=this.renderFunctionBox(t.id,t.text,t.parameters),d=document.createElement("div");d.classList.add("container","fixedHeight");const l=this.createOptionDiv(t.type,t.id);d.appendChild(l),s.appendChild(d);const r=document.createElement("div");r.classList.add("columnAuto","container","loopShift");const c=document.createElement("div");c.classList.add("loopWidth","frameLeft","vcontainer");for(const e of this.renderElement(t.child,!1,o))this.applyCodeEventListeners(e),c.appendChild(e);r.appendChild(c);const p=document.createElement("div");p.classList.add("container","fixedHeight","padding");const h=document.createElement("div");h.classList.add("symbol"),h.appendChild(document.createTextNode("}")),p.appendChild(h);const u=document.createElement("div");u.classList.add("frameLeftBottom"),u.style.flex="0 0 3px";const m=document.createElement("div");m.classList.add("container","columnAuto","loopShift");const f=document.createElement("div");return f.classList.add("loopWidth","vcontainer"),f.appendChild(u),m.appendChild(f),e.appendChild(s),e.appendChild(r),e.appendChild(m),e.appendChild(p),a.appendChild(e),i.push(a),i.concat(this.renderElement(t.followElement,n,o))}case"FootLoopNode":{const e=document.createElement("div");e.classList.add("columnAuto","vcontainer");const s=document.createElement("div");s.classList.add("columnAuto","container","loopShift");const d=document.createElement("div");d.classList.add("loopWidth","frameLeftBottom","vcontainer");for(const e of this.renderElement(t.child,!1,o))this.applyCodeEventListeners(e),d.appendChild(e);const l=document.createElement("div");l.classList.add("borderHeight"),d.appendChild(l),s.appendChild(d),e.appendChild(s);const r=document.createElement("div");r.classList.add("container","fixedHeight");const c=this.createTextDiv(t.type,t.text,t.id),p=this.createOptionDiv(t.type,t.id);return r.appendChild(c),r.appendChild(p),e.appendChild(r),a.appendChild(e),i.push(a),i.concat(this.renderElement(t.followElement,n,o))}case"CaseNode":{const e=document.createElement("div");e.classList.add("columnAuto","vcontainer");const s=document.createElement("div");s.classList.add("vcontainer","fixedHeight"),t.defaultOn?s.classList.add("caseHead-"+t.cases.length):s.classList.add("caseHead-noDefault-"+t.cases.length),s.style.backgroundPosition="1px 0px";let d=t.cases.length;t.defaultOn||(d+=2);const l=this.createTextDiv(t.type,t.text,t.id,d),r=this.createOptionDiv(t.type,t.id);s.appendChild(l),s.appendChild(r),e.appendChild(s);const c=document.createElement("div");if(c.classList.add("columnAuto","container"),t.defaultOn)c.classList.add("caseBody-"+t.cases.length);else{const e=t.cases.length-1;c.classList.add("caseBody-"+e)}for(const e of t.cases){const t=document.createElement("div");t.classList.add("columnAuto","vcontainer","ov-hidden");for(const n of this.renderElement(e,!1,o))this.applyCodeEventListeners(n),t.appendChild(n);c.appendChild(t)}if(t.defaultOn){const e=document.createElement("div");e.classList.add("columnAuto","vcontainer","ov-hidden");for(const n of this.renderElement(t.defaultNode,!1,o))this.applyCodeEventListeners(n),e.appendChild(n);c.appendChild(e)}return e.appendChild(c),a.appendChild(e),i.push(a),i.concat(this.renderElement(t.followElement,n,o))}}}}resetButtons(){for(const t of this.buttonList)e.get()[t].use&&document.getElementById(e.get()[t].id).classList.remove("boldText")}increaseSize(){if(this.size<10){const e=document.getElementById("Sizelimiter");e.classList.remove("col-"+this.size),this.size=this.size+1,e.classList.add("col-"+this.size)}}decreaseSize(){if(this.size>6){const e=document.getElementById("Sizelimiter");e.classList.remove("col-"+this.size),this.size=this.size-1,e.classList.add("col-"+this.size)}}addCssWrapper(e,t,n){const o=document.createElement("div");o.classList.add("column"),o.classList.add("col-12"),o.classList.add("lineTop");const s=document.createElement("div");return s.classList.add("row"),t&&(s.classList.add("bg-secondary"),s.classList.add("simpleBorder")),n&&(s.classList.add("bg-primary"),s.classList.add("simpleBorder")),o.appendChild(e),s.appendChild(o),s}openCaseOptions(t){const n=document.getElementById("modal-content"),o=document.getElementById("modal-footer");for(;n.hasChildNodes();)n.removeChild(n.lastChild);for(;o.hasChildNodes();)o.removeChild(o.lastChild);const s=this.presenter.getElementByUid(t),d=document.createElement("strong");d.appendChild(document.createTextNode("Einstellungen der "+e.get().CaseNode.text+": ")),n.appendChild(d);const i=document.createElement("div");i.classList.add("caseTitle","boldText"),i.appendChild(document.createTextNode(s.text)),n.appendChild(i);const a=document.createElement("dl");a.classList.add("container"),n.appendChild(a);const l=document.createElement("dt");l.classList.add("dtItem"),l.appendChild(document.createTextNode("Anzahl der Fälle:")),a.appendChild(l);const r=document.createElement("dd");r.classList.add("ddItem","container"),a.appendChild(r);const c=document.createElement("div");c.classList.add("text-center","shortenOnMobile"),c.appendChild(document.createTextNode(s.cases.length)),r.appendChild(c);const p=document.createElement("div");p.classList.add("addCaseIcon","hand","caseOptionsIcons","tooltip","tooltip-bottom"),p.addEventListener("click",(()=>{this.presenter.addCase(t),this.openCaseOptions(t)})),p.setAttribute("data-tooltip","Fall hinzufügen"),r.appendChild(p);const h=document.createElement("dt");h.classList.add("dtItem"),h.appendChild(document.createTextNode("Sonst Zweig einschalten:")),a.appendChild(h);const u=document.createElement("dd");u.classList.add("ddItem","container"),u.addEventListener("click",(()=>{this.presenter.switchDefaultState(t),this.openCaseOptions(t)})),a.appendChild(u);const m=document.createElement("div");m.classList.add("text-center","shortenOnMobile"),m.setAttribute("data-abbr","N"),u.appendChild(m);const f=document.createElement("span");f.appendChild(document.createTextNode("Nein")),m.appendChild(f);const C=document.createElement("div");C.classList.add("hand","caseOptionsIcons"),s.defaultOn?C.classList.add("switchOn"):C.classList.add("switchOff"),u.appendChild(C);const E=document.createElement("div");E.classList.add("text-center","shortenOnMobile"),E.setAttribute("data-abbr","J"),u.appendChild(E);const g=document.createElement("span");g.appendChild(document.createTextNode("Ja")),E.appendChild(g);const L=document.createElement("div");L.classList.add("modal-buttons","hand"),L.appendChild(document.createTextNode("Schließen")),L.addEventListener("click",(()=>document.getElementById("IEModal").classList.remove("active"))),o.appendChild(L),document.getElementById("IEModal").classList.add("active")}createOptionDiv(e,t){const n=document.createElement("div");if(n.classList.add("optionContainer"),"CaseNode"===e){const e=document.createElement("div");e.classList.add("gearIcon","optionIcon","hand","tooltip","tooltip-bottoml"),e.setAttribute("data-tooltip","Einstellung"),e.addEventListener("click",(()=>this.openCaseOptions(t))),n.appendChild(e)}if("InsertCase"!==e&&"FunctionNode"!==e){const e=document.createElement("div");e.classList.add("moveIcon"),e.classList.add("optionIcon"),e.classList.add("hand"),e.classList.add("tooltip"),e.classList.add("tooltip-bottoml"),e.setAttribute("data-tooltip","Verschieben"),e.addEventListener("click",(()=>this.presenter.moveElement(t))),n.appendChild(e)}const o=document.createElement("div");return o.classList.add("trashcan"),o.classList.add("optionIcon"),o.classList.add("hand"),o.classList.add("tooltip"),o.classList.add("tooltip-bottoml"),o.setAttribute("data-tooltip","Entfernen"),o.addEventListener("click",(()=>this.presenter.removeElement(t))),n.appendChild(o),n}createTextDiv(e,t,n,o=null){const s=document.createElement("div");s.classList.add("columnAuto","symbol");const d=document.createElement("div");d.classList.add("input-group","editField"),d.style.display="none","FootLoopNode"===e&&d.classList.add(n);const i=document.createElement("input");i.type="text",i.value=t,i.addEventListener("keyup",(e=>{13===e.keyCode&&this.presenter.editElement(n,i.value),27===e.keyCode&&this.presenter.renderAllViews()}));const a=document.createElement("div");a.classList.add("acceptIcon","hand"),a.addEventListener("click",(()=>this.presenter.editElement(n,i.value)));const l=document.createElement("div");switch(l.classList.add("deleteIcon","hand"),l.addEventListener("click",(()=>this.presenter.renderAllViews())),e){case"InputNode":t="E: "+t;break;case"OutputNode":t="A: "+t;break;case"BranchNode":case"InsertCase":s.classList.add("text-center")}const r=document.createElement("div");"InsertCase"===e&&"Sonst"===t||(r.classList.add("padding"),this.presenter.getInsertMode()||r.classList.add("hand","fullHeight"),r.addEventListener("click",(()=>{this.presenter.renderAllViews(),this.presenter.switchEditState(n)})));const c=document.createElement("span");"CaseNode"===e&&(c.style.marginLeft="calc("+o/(o+1)*100+"% - 2em)");const p=document.createTextNode(t);return d.appendChild(i),d.appendChild(a),d.appendChild(l),c.appendChild(p),r.appendChild(c),s.appendChild(r),s.appendChild(d),s}applyCodeEventListeners(e){e.firstChild.classList.contains("func-box-header")||(e.firstChild.firstChild.classList.contains("loopShift")?(e.firstChild.lastChild.addEventListener("mouseover",(function(){const t=document.getElementById(e.id+"-codeLine");t&&t.classList.add("highlight")})),e.firstChild.lastChild.addEventListener("mouseout",(function(){const t=document.getElementById(e.id+"-codeLine");t&&t.classList.remove("highlight")}))):(e.firstChild.firstChild.addEventListener("mouseover",(function(){const t=document.getElementById(e.id+"-codeLine");t&&t.classList.add("highlight")})),e.firstChild.firstChild.addEventListener("mouseout",(function(){const t=document.getElementById(e.id+"-codeLine");t&&t.classList.remove("highlight")}))))}prepareRenderTree(e,t,n){if(null===e||"InsertNode"===e.type&&null===e.followElement&&!this.presenter.getInsertMode())return document.createTextNode("");{const o=document.createElement("div");o.classList.add("column"),o.classList.add("col-12");const s=document.createElement("div");return s.classList.add("columns"),"InsertCase"!==e.type&&s.classList.add("lineTop"),this.renderTree(e,t,n).forEach((function(e){o.appendChild(e)})),s.appendChild(o),s}}renderTree(e,t,n){if(null===e)return[];switch(null!==this.presenter.getMoveId()&&e.id===this.presenter.getMoveId()&&(t=!0,n=!0),e.type){case"InsertNode":if(t)return this.renderTree(e.followElement,!1,!1);if(n)return this.renderTree(e.followElement,!1,!0);if(this.presenter.getInsertMode()){const o=document.createElement("div");o.id=e.id,o.addEventListener("dragover",(function(e){e.preventDefault()})),o.addEventListener("drop",(()=>this.presenter.appendElement(e.id))),o.addEventListener("click",(()=>this.presenter.appendElement(e.id)));const s=document.createElement("div");if(this.presenter.getMoveId()&&e.followElement&&e.followElement.id===this.presenter.getMoveId()){const e=document.createElement("strong");e.appendChild(document.createTextNode("Verschieben abbrechen")),s.appendChild(e)}else s.classList.add("insertIcon");return o.appendChild(s),null===e.followElement||"Placeholder"===e.followElement.type?[this.addCssWrapper(o,!0,t)]:[this.addCssWrapper(o,!0,t),this.prepareRenderTree(e.followElement,!1,n)]}return this.renderTree(e.followElement,t,n);case"Placeholder":if(this.presenter.getInsertMode())return[];{const e=document.createElement("div");e.classList.add("text-center");const t=document.createElement("div");return t.classList.add("emptyStateIcon"),t.classList.add("p-centered"),e.appendChild(t),[e]}case"InputNode":case"OutputNode":case"TaskNode":{const o=document.createElement("div");o.id=e.id,o.classList.add("columns"),o.classList.add("element");const s=this.createTextDiv(e.type,e.text,e.id),d=this.createOptionDiv(e.type,e.id);return o.appendChild(s),o.appendChild(d),[this.addCssWrapper(o,!1,t),this.prepareRenderTree(e.followElement,t,n)]}case"FunctionNode":{const o=document.createElement("div");o.id=e.id,o.classList.add(["columns","element"]);const s=this.createOptionDiv(e.type,e.id);return o.appendChild(s),[this.addCssWrapper(o,!1,t),this.prepareRenderTree(e.followElement,t,n)]}case"BranchNode":{const o=document.createElement("div");o.id=e.id;const s=document.createElement("div");s.classList.add("columns"),s.classList.add("element"),s.classList.add("stBranch");const d=this.createTextDiv(e.type,e.text,e.id),i=this.createOptionDiv(e.type,e.id),a=document.createElement("div");a.classList.add("column"),a.classList.add("col-1"),s.appendChild(a),s.appendChild(d),s.appendChild(i);const l=document.createElement("div");l.classList.add("column"),l.classList.add("col-12");const r=document.createElement("div");r.classList.add("columns");const c=document.createElement("div");c.classList.add("column"),c.classList.add("col-6"),c.appendChild(document.createTextNode("Wahr"));const p=document.createElement("div");p.classList.add("column"),p.classList.add("col-6"),p.classList.add("text-right"),p.appendChild(document.createTextNode("Falsch")),r.appendChild(c),r.appendChild(p),l.appendChild(r),s.appendChild(l);const h=document.createElement("div");h.classList.add("column"),h.classList.add("col-6"),h.appendChild(this.prepareRenderTree(e.trueChild,!1,n));const u=document.createElement("div");u.classList.add("column"),u.classList.add("col-6"),u.appendChild(this.prepareRenderTree(e.falseChild,!1,n));const m=document.createElement("div");return m.classList.add("columns"),m.classList.add("middleBranch"),m.appendChild(h),m.appendChild(u),o.appendChild(s),o.appendChild(m),[this.addCssWrapper(o,!1,t),this.prepareRenderTree(e.followElement,t,n)]}case"HeadLoopNode":case"CountLoopNode":{const o=document.createElement("div");o.id=e.id;const s=document.createElement("div");s.classList.add("columns"),s.classList.add("element");const d=this.createTextDiv(e.type,e.text,e.id),i=this.createOptionDiv(e.type,e.id);s.appendChild(d),s.appendChild(i);const a=document.createElement("div");a.classList.add("column"),a.classList.add("col-12"),a.appendChild(this.prepareRenderTree(e.child,!1,n));const l=document.createElement("div");l.classList.add("columns"),l.appendChild(a);const r=document.createElement("div");r.classList.add("column"),r.classList.add("col-11"),r.classList.add("col-ml-auto"),r.classList.add("lineLeft"),r.appendChild(l);const c=document.createElement("div");return c.classList.add("columns"),c.appendChild(r),o.appendChild(s),o.appendChild(c),[this.addCssWrapper(o,!1,t),this.prepareRenderTree(e.followElement,t,n)]}case"FootLoopNode":{const o=document.createElement("div");o.id=e.id;const s=document.createElement("div");s.classList.add("columns"),s.classList.add("element"),s.classList.add("lineTopFootLoop");const d=this.createTextDiv(e.type,e.text,e.id),i=this.createOptionDiv(e.type,e.id);s.appendChild(d),s.appendChild(i);const a=document.createElement("div");a.classList.add("column"),a.classList.add("col-11"),a.classList.add("col-ml-auto"),a.classList.add("lineLeft"),a.appendChild(this.prepareRenderTree(e.child,!1,n));const l=document.createElement("div");return l.classList.add("columns"),l.appendChild(a),o.appendChild(l),o.appendChild(s),[this.addCssWrapper(o,!1,t),this.prepareRenderTree(e.followElement,t,n)]}case"CaseNode":{const o=document.createElement("div");o.id=e.id;const s=document.createElement("div");s.classList.add("columns"),s.classList.add("element"),e.defaultOn?s.classList.add("caseHead-"+e.cases.length):s.classList.add("caseHead-noDefault-"+e.cases.length);const d=this.createTextDiv(e.type,e.text,e.id),i=this.createOptionDiv(e.type,e.id),a=document.createElement("div");a.classList.add("column"),a.classList.add("col-1"),s.appendChild(a),s.appendChild(d),s.appendChild(i);const l=document.createElement("div");l.classList.add("column"),l.classList.add("col-12");const r=document.createElement("div");if(r.classList.add("columns"),e.defaultOn)r.classList.add("caseBody-"+e.cases.length);else{const t=e.cases.length-1;r.classList.add("caseBody-"+t)}for(const t of e.cases){const e=document.createElement("div");e.classList.add("column"),e.appendChild(this.prepareRenderTree(t,!1,n)),r.appendChild(e)}if(e.defaultOn){const t=document.createElement("div");t.classList.add("column"),t.appendChild(this.prepareRenderTree(e.defaultNode,!1,n)),r.appendChild(t)}return o.appendChild(s),o.appendChild(r),[this.addCssWrapper(o,!1,t),this.prepareRenderTree(e.followElement,t,n)]}case"InsertCase":{const o=document.createElement("div");o.id=e.id,o.classList.add("columns"),o.classList.add("element");const s=document.createElement("div");s.classList.add("column"),s.classList.add("col-1");const d=this.createTextDiv(e.type,e.text,e.id),i=this.createOptionDiv(e.type,e.id);return o.appendChild(s),o.appendChild(d),o.appendChild(i),[o,this.prepareRenderTree(e.followElement,t,n)]}default:return this.renderTree(e.followElement,t,n)}}displaySourcecode(e){}setLang(){}}class a{constructor(e,t){this.presenter=e,this.domRoot=t,this.lang="--",this.translationMap={Python:{untranslatable:[],InputNode:{pre:"",post:' = input("Eingabe")\n'},OutputNode:{pre:"print(",post:")\n"},TaskNode:{pre:"",post:"\n"},BranchNode:{pre:"if ",post:":\n",between:"else:\n"},TryCatchNode:{pre:"try:\n",between:"except",post:":\n"},CountLoopNode:{pre:"for ",post:":\n"},HeadLoopNode:{pre:"while ",post:":\n"},FunctionNode:{pre:"def ",between:"(",post:"):\n"},FootLoopNode:{prepre:"while True:\n",pre:"    if not ",post:":\n        break\n"},CaseNode:{pre:"if ",post:":\n"},InsertCase:{preNormal:"elif ",preDefault:"default",post:":\n",postpost:"\n"},leftBracket:"",rightBracket:"",pseudoSwitch:!0},"Python ab v3.10":{untranslatable:[],InputNode:{pre:"",post:' = input("Eingabe")\n'},OutputNode:{pre:"print(",post:")\n"},TaskNode:{pre:"",post:"\n"},BranchNode:{pre:"if ",post:":\n",between:"else:\n"},TryCatchNode:{pre:"try:\n",between:"except",post:":\n"},CountLoopNode:{pre:"for ",post:":\n"},HeadLoopNode:{pre:"while ",post:":\n"},FunctionNode:{pre:"def ",between:"(",post:"):\n"},FootLoopNode:{prepre:"while True:\n",pre:"    if not ",post:":\n        break\n"},CaseNode:{pre:"match ",post:":\n"},InsertCase:{preNormal:"case ",preDefault:"case _",post:":\n",postpost:"\n"},leftBracket:"",rightBracket:"",pseudoSwitch:!1},PHP:{untranslatable:[],InputNode:{pre:"",post:' = readline("Eingabe");\n'},OutputNode:{pre:"echo ",post:";\n"},TaskNode:{pre:"",post:";\n"},BranchNode:{pre:"if (",post:")\n",between:"} else {\n"},TryCatchNode:{pre:"try\n",between:"catch (",post:")\n"},CountLoopNode:{pre:"for (",post:")\n"},HeadLoopNode:{pre:"while (",post:")\n"},FootLoopNode:{prepre:"do\n",pre:"while (",post:");\n"},FunctionNode:{pre:"function ",between:"(",post:")\n"},CaseNode:{pre:"switch (",post:")\n"},InsertCase:{preNormal:"case ",preDefault:"default",post:":\n",postpost:"break;\n"},leftBracket:"{",rightBracket:"}",pseudoSwitch:!1},Java:{untranslatable:[],InputNode:{pre:"",post:" = System.console().readLine();\n"},OutputNode:{pre:"System.out.println(",post:");\n"},TaskNode:{pre:"",post:";\n"},BranchNode:{pre:"if (",post:")\n",between:"} else {\n"},TryCatchNode:{pre:"try\n",between:"catch (",post:")\n"},CountLoopNode:{pre:"for (",post:")\n"},HeadLoopNode:{pre:"while (",post:")\n"},FootLoopNode:{prepre:"do\n",pre:"while (",post:");\n"},FunctionNode:{pre:"public void ",between:"(",post:")\n"},CaseNode:{pre:"switch (",post:")\n"},InsertCase:{preNormal:"case ",preDefault:"default",post:":\n",postpost:"break;\n"},leftBracket:"{",rightBracket:"}",pseudoSwitch:!1},"C#":{untranslatable:[],InputNode:{pre:"",post:" = Console.ReadLine();\n"},OutputNode:{pre:"Console.WriteLine(",post:");\n"},TaskNode:{pre:"",post:";\n"},BranchNode:{pre:"if (",post:")\n",between:"} else {\n"},TryCatchNode:{pre:"try\n",between:"catch (",post:")\n"},CountLoopNode:{pre:"for (",post:")\n"},HeadLoopNode:{pre:"while (",post:")\n"},FootLoopNode:{prepre:"do\n",pre:"while (",post:");\n"},FunctionNode:{pre:"public void ",between:"(",post:")\n"},CaseNode:{pre:"switch (",post:")\n"},InsertCase:{preNormal:"case ",preDefault:"default",post:":\n",postpost:"break;\n"},leftBracket:"{",rightBracket:"}",pseudoSwitch:!1},"C++":{untranslatable:[],InputNode:{pre:"std::cin >> ",post:";\n"},OutputNode:{pre:"std::cout << ",post:";\n"},TaskNode:{pre:"",post:";\n"},BranchNode:{pre:"if (",post:")\n",between:"} else {\n"},TryCatchNode:{pre:"try\n",between:"catch (",post:")\n"},CountLoopNode:{pre:"for (",post:")\n"},HeadLoopNode:{pre:"while (",post:")\n"},FootLoopNode:{prepre:"do\n",pre:"while (",post:");\n"},FunctionNode:{pre:"void ",between:"(",post:")\n"},CaseNode:{pre:"switch (",post:")\n"},InsertCase:{preNormal:"case ",preDefault:"default",post:":\n",postpost:"break;\n"},leftBracket:"{",rightBracket:"}",pseudoSwitch:!1},C:{untranslatable:["TryCatchNode"],InputNode:{pre:"scanf(",post:");\n"},OutputNode:{pre:"printf(",post:");\n"},TaskNode:{pre:"",post:";\n"},BranchNode:{pre:"if (",post:")\n",between:"} else {\n"},TryCatchNode:{pre:"",between:"",post:""},CountLoopNode:{pre:"for (",post:")\n"},HeadLoopNode:{pre:"while (",post:")\n"},FootLoopNode:{prepre:"do\n",pre:"while (",post:");\n"},FunctionNode:{pre:"void ",between:"(",post:")\n"},CaseNode:{pre:"switch (",post:")\n"},InsertCase:{preNormal:"case ",preDefault:"default",post:":\n",postpost:"break;\n"},leftBracket:"{",rightBracket:"}",pseudoSwitch:!1}},this.preRender()}preRender(){const e=document.getElementById("SourcecodeDisplay"),t=document.createElement("div");t.classList.add("fixFullWidth","margin-top-small");const n=document.createElement("div");n.classList.add("columnAuto","container");const o=document.createElement("strong");o.classList.add("center"),o.appendChild(document.createTextNode("Übersetzen in:"));const s=document.createElement("div");s.classList.add("center");const d=document.createElement("select");d.classList.add("form-select"),d.id="SourcecodeSelect",d.addEventListener("change",(e=>this.presenter.startTransforming(e)));const i=document.createElement("option");i.value="--",i.appendChild(document.createTextNode("--")),d.appendChild(i);for(const e in this.translationMap){const t=document.createElement("option");t.value=e,t.appendChild(document.createTextNode(e)),d.appendChild(t)}const a=document.createElement("div");a.setAttribute("data-tooltip","Kopiere Code"),a.classList.add("center","copyIcon","struktoOption","sourcecodeHeader","hand","tooltip"),e.addEventListener("click",(function(e){navigator.clipboard.writeText(localStorage.getItem("struktog_code"))})),s.appendChild(d),n.appendChild(o),n.appendChild(s),n.appendChild(a);const l=document.createElement("div");if(l.classList.add("columnAuto"),l.id="Sourcecode",t.appendChild(n),t.appendChild(l),e.appendChild(t),this.domRoot=document.getElementById("Sourcecode"),this.generateCodeSwitch(this.presenter,document.getElementById("struktoOptions1")),this.generateCodeSwitch(this.presenter,document.getElementById("struktoOptions2")),"undefined"!=typeof Storage&&"displaySourcecode"in localStorage&&"lang"in localStorage){const e=localStorage.lang;e in this.translationMap&&(this.lang=e,d.value=this.lang,this.presenter.setSourcecodeDisplay(JSON.parse(localStorage.displaySourcecode)),this.displaySourcecode("ToggleSourcecode"))}}render(e){for(;this.domRoot.hasChildNodes();)this.domRoot.removeChild(this.domRoot.lastChild);if("--"!==this.lang){let t=!1;for(const n of this.translationMap[this.lang].untranslatable)t=t||this.checkForUntranslatable(e,n);const n=document.createElement("pre");n.classList.add("code"),n.setAttribute("data-lang",this.lang);const o=document.createElement("code");let s="";t?o.appendChild(document.createTextNode("Das Struktogramm enthält Elemente, \nwelche in der gewählten Programmiersprache \nnicht direkt zur Verfügung stehen.\nDeshalb bitte manuell in Code überführen.")):this.transformToCode(e,0,this.lang).forEach((function(e){o.appendChild(e),s+=e.textContent})),localStorage.setItem("struktog_code",s),n.appendChild(o),this.domRoot.appendChild(n)}}generateCodeSwitch(e,t){const n=document.createElement("div");n.classList.add("struktoOption","codeIcon","tooltip","tooltip-bottomCode","hand","ToggleSourcecode"),n.setAttribute("data-tooltip","Quellcode einblenden"),n.addEventListener("click",(t=>e.alterSourcecodeDisplay(t))),t.appendChild(n)}setLang(e){"undefined"!=typeof Storage&&(localStorage.lang=e,localStorage.displaySourcecode=!0),this.lang=e}resetButtons(){}addIndentations(e){let t="";for(let n=0;n<e;n++)t+="    ";return t}createHighlightedSpan(e){const t=document.createElement("span");return t.classList.add("text-code"),t.appendChild(document.createTextNode(e)),t}checkForUntranslatable(e,t){if("Placeholder"===e.type||"InsertNode"===e.type&&null===e.followElement)return!1;if(e.type===t)return!0;switch(e.type){case"InsertNode":case"InputNode":case"OutputNode":case"TaskNode":return this.checkForUntranslatable(e.followElement,t);case"BranchNode":return this.checkForUntranslatable(e.trueChild,t)||this.checkForUntranslatable(e.falseChild,t)||this.checkForUntranslatable(e.followElement,t);case"TryCatchNode":return this.checkForUntranslatable(e.tryChild,t)||this.checkForUntranslatable(e.catchChild,t)||this.checkForUntranslatable(e.followElement,t);case"CountLoopNode":case"HeadLoopNode":case"FootLoopNode":case"FunctionNode":return this.checkForUntranslatable(e.child,t)||this.checkForUntranslatable(e.followElement,t);case"CaseNode":{let n=!1;for(let o=0;o<e.length;o++)n=n||this.checkForUntranslatable(e.cases[o],t);return n=n||this.checkForUntranslatable(e.defaultNode,t),n||this.checkForUntranslatable(e.followElement,t)}}}transformToCode(e,t,n,o=!1){if("Placeholder"===e.type||"InsertNode"===e.type&&null===e.followElement)return[];{const s=document.createElement("span");s.id=e.id+"-codeLine",s.addEventListener("mouseover",(function(){document.getElementById(e.id).firstChild.classList.add("highlight")})),s.addEventListener("mouseout",(function(){document.getElementById(e.id).firstChild.classList.remove("highlight")}));const i=this.createHighlightedSpan(e.text);switch(i.classList.add("hand"),i.addEventListener("click",(()=>this.presenter.switchEditState(e.id))),e.type){case"InsertNode":return this.transformToCode(e.followElement,t,n);case"InputNode":{const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].InputNode.pre)),s.appendChild(o),s.appendChild(i);const d=document.createElement("span");return d.classList.add("keyword"),d.appendChild(document.createTextNode(this.translationMap[n].InputNode.post)),s.appendChild(d),[s].concat(this.transformToCode(e.followElement,t,n))}case"OutputNode":{const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].OutputNode.pre)),s.appendChild(o),s.appendChild(i);const d=document.createElement("span");return d.classList.add("keyword"),d.appendChild(document.createTextNode(this.translationMap[n].OutputNode.post)),s.appendChild(d),[s].concat(this.transformToCode(e.followElement,t,n))}case"TaskNode":{const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].TaskNode.pre)),s.appendChild(o),s.appendChild(i);const d=document.createElement("span");return d.classList.add("keyword"),d.appendChild(document.createTextNode(this.translationMap[n].TaskNode.post)),s.appendChild(d),[s].concat(this.transformToCode(e.followElement,t,n))}case"BranchNode":{const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].BranchNode.pre)),s.appendChild(o),s.appendChild(i);const d=document.createElement("span");d.classList.add("keyword"),d.appendChild(document.createTextNode(this.translationMap[n].BranchNode.post)),s.appendChild(d);let a=[s];if(""!==this.translationMap[n].leftBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].leftBracket+"\n")),a.push(e)}const l=this.transformToCode(e.trueChild,t+1,n),r=this.transformToCode(e.falseChild,t+1,n);if(a=a.concat(l),r.length>0){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].BranchNode.between)),a.push(e)}if(a=a.concat(r),""!==this.translationMap[n].rightBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].rightBracket+"\n")),a.push(e)}return a.concat(this.transformToCode(e.followElement,t,n))}case"TryCatchNode":{d("span",["keyword"],s).appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].TryCatchNode.pre));let o=[s];if(""!==this.translationMap[n].leftBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].leftBracket+"\n")),o.push(e)}const a=this.transformToCode(e.tryChild,t+1,n);if(o=o.concat(a),""!==this.translationMap[n].rightBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].rightBracket+"\n")),o.push(e)}const l=d("span",["keyword"]);l.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].TryCatchNode.between)),""!==i.innerText&&n.includes("Python")&&l.appendChild(document.createTextNode(" ")),l.appendChild(i),o.push(l);const r=d("span",["keyword"]);r.appendChild(document.createTextNode(this.translationMap[n].TryCatchNode.post)),o.push(r);const c=this.transformToCode(e.catchChild,t+1,n);if(""!==this.translationMap[n].leftBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].leftBracket+"\n")),o.push(e)}if(o=o.concat(c),""!==this.translationMap[n].rightBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].rightBracket+"\n")),o.push(e)}return o.concat(this.transformToCode(e.followElement,t,n))}case"CountLoopNode":{const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].CountLoopNode.pre)),s.appendChild(o),s.appendChild(i);const d=document.createElement("span");d.classList.add("keyword"),d.appendChild(document.createTextNode(this.translationMap[n].CountLoopNode.post)),s.appendChild(d);let a=[s];if(""!==this.translationMap[n].leftBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].leftBracket+"\n")),a.push(e)}if(a=a.concat(this.transformToCode(e.child,t+1,n)),""!==this.translationMap[n].rightBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].rightBracket+"\n")),a.push(e)}return a.concat(this.transformToCode(e.followElement,t,n))}case"HeadLoopNode":{const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].HeadLoopNode.pre)),s.appendChild(o),s.appendChild(i);const d=document.createElement("span");d.classList.add("keyword"),d.appendChild(document.createTextNode(this.translationMap[n].HeadLoopNode.post)),s.appendChild(d);let a=[s];if(""!==this.translationMap[n].leftBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].leftBracket+"\n")),a.push(e)}if(a=a.concat(this.transformToCode(e.child,t+1,n)),""!==this.translationMap[n].rightBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].rightBracket+"\n")),a.push(e)}return a.concat(this.transformToCode(e.followElement,t,n))}case"FootLoopNode":{const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].FootLoopNode.prepre)),s.appendChild(o);let d=[s];if(""!==this.translationMap[n].leftBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].leftBracket+"\n")),d.push(e)}const a=this.transformToCode(e.child,t+1,n);if(d=d.concat(a),""!==this.translationMap[n].rightBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].rightBracket+"\n")),d.push(e)}const l=document.createElement("span");l.id=e.id+"-codeLine",s.id="";const r=document.createElement("span");r.classList.add("keyword"),r.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].FootLoopNode.pre)),l.appendChild(r),l.appendChild(i);const c=document.createElement("span");return c.classList.add("keyword"),c.appendChild(document.createTextNode(this.translationMap[n].FootLoopNode.post)),l.appendChild(c),l.addEventListener("mouseover",(function(){document.getElementById(e.id).firstChild.classList.add("highlight")})),l.addEventListener("mouseout",(function(){document.getElementById(e.id).firstChild.classList.remove("highlight")})),d.push(l),d.concat(this.transformToCode(e.followElement,t,n))}case"FunctionNode":{const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].FunctionNode.pre)),s.appendChild(o),s.appendChild(i);const d=document.createElement("span");d.classList.add("keyword"),d.appendChild(document.createTextNode(this.translationMap[n].FunctionNode.between)),s.appendChild(d);const a=e.parameters;let l=0;for(const t of a){0!==l&&s.appendChild(this.createHighlightedSpan(", "));const n=this.createHighlightedSpan(t.parName);n.classList.add("hand"),n.addEventListener("click",(()=>this.presenter.switchEditState(e.id,t.pos/3*2))),s.appendChild(n),l+=1}const r=document.createElement("span");r.classList.add("keyword"),r.appendChild(document.createTextNode(this.translationMap[n].FunctionNode.post)),s.appendChild(r);let c=[s];if(""!==this.translationMap[n].leftBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].leftBracket+"\n")),c.push(e)}if(c=c.concat(this.transformToCode(e.child,t+1,n)),""!==this.translationMap[n].rightBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].rightBracket+"\n")),c.push(e)}return c.concat(this.transformToCode(e.followElement,t,n))}case"CaseNode":{if(!this.translationMap[n].pseudoSwitch){const e=document.createElement("span");e.classList.add("keyword"),e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].CaseNode.pre)),s.appendChild(e),s.appendChild(i);const o=document.createElement("span");o.classList.add("keyword"),o.appendChild(document.createTextNode(this.translationMap[n].CaseNode.post)),s.appendChild(o)}let o=[s];if(this.translationMap[n].pseudoSwitch&&(o=[]),""!==this.translationMap[n].leftBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].leftBracket+"\n")),o.push(e)}for(const s of e.cases)if(this.translationMap[n].pseudoSwitch){const d=this.createHighlightedSpan(e.text);d.classList.add("hand"),d.addEventListener("click",(()=>this.presenter.switchEditState(e.id))),o=o.concat(this.transformToCode(s,t,n,d))}else o=o.concat(this.transformToCode(s,t+1,n));if(this.translationMap[n].pseudoSwitch&&(o[0].firstChild.innerText="if "),e.defaultOn){const s=document.createElement("span");if(s.classList.add("keyword"),s.id=e.defaultNode.id+"-codeLine",this.translationMap[n].pseudoSwitch?s.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].InsertCase.preDefault+this.translationMap[n].InsertCase.post)):s.appendChild(document.createTextNode(this.addIndentations(t+1)+this.translationMap[n].InsertCase.preDefault+this.translationMap[n].InsertCase.post)),s.addEventListener("mouseover",(function(){document.getElementById(e.defaultNode.id).firstChild.classList.add("highlight")})),s.addEventListener("mouseout",(function(){document.getElementById(e.defaultNode.id).firstChild.classList.remove("highlight")})),o.push(s),o=this.translationMap[n].pseudoSwitch?o.concat(this.transformToCode(e.defaultNode.followElement,t+1,n)):o.concat(this.transformToCode(e.defaultNode.followElement,t+2,n)),!this.translationMap[n].pseudoSwitch&&("C#"===n||"Java"===n)){const e=document.createElement("span");e.classList.add("keyword"),e.appendChild(document.createTextNode(this.addIndentations(t+2)+this.translationMap[n].InsertCase.postpost)),o.push(e)}}if(""!==this.translationMap[n].rightBracket){const e=document.createElement("span");e.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].rightBracket+"\n")),o.push(e)}return o.concat(this.transformToCode(e.followElement,t,n))}case"InsertCase":{const d=document.createElement("span");if(d.classList.add("keyword"),d.appendChild(document.createTextNode(this.addIndentations(t)+this.translationMap[n].InsertCase.preNormal)),s.appendChild(d),o){s.appendChild(o);const e=document.createElement("span");e.appendChild(document.createTextNode(" == ")),s.appendChild(e)}s.appendChild(i);const a=document.createElement("span");a.classList.add("keyword"),a.appendChild(document.createTextNode(this.translationMap[n].InsertCase.post)),s.appendChild(a);let l=[s];if(l=l.concat(this.transformToCode(e.followElement,t+1,n)),!this.translationMap[n].pseudoSwitch){const e=document.createElement("span");e.classList.add("keyword"),e.appendChild(document.createTextNode(this.addIndentations(t+1)+this.translationMap[n].InsertCase.postpost)),l.push(e)}return l}}}}prepareTransforming(){const e=document.getElementById("SourcecodeSelect").value;presenter.startTransforming(e)}displaySourcecode(e){const t=document.getElementsByClassName(e);if(this.presenter.getSourcecodeDisplay()){for(const e of t)e.setAttribute("data-tooltip","Quellcode ausblenden");document.getElementById("SourcecodeDisplay").style.display="block",window.matchMedia("(max-width: 1200px)")&&(document.getElementById("editorContent").style.flexBasis="75%")}else{for(const e of t)e.setAttribute("data-tooltip","Quellcode einblenden");document.getElementById("SourcecodeDisplay").style.display="none",window.matchMedia("(max-width: 1200px)")&&(document.getElementById("editorContent").style.flexBasis="100%")}}}class l{constructor(e,t){this.presenter=e,this.domRoot=t,this.printHeight=32,this.preRender()}render(e){}preRender(){const e=document.createElement("div");e.classList.add("options-element","uploadIcon","tooltip","tooltip-bottom","hand"),e.setAttribute("data-tooltip","Hochladen");const t=document.createElement("input");t.setAttribute("type","file"),t.addEventListener("change",(e=>this.presenter.readFile(e))),e.addEventListener("click",(()=>t.click())),document.getElementById("optionButtons").appendChild(e);const n=document.createElement("div");n.classList.add("options-element","saveIcon","tooltip","tooltip-bottom","hand"),n.setAttribute("data-tooltip","Herunterladen"),n.addEventListener("click",(()=>this.presenter.saveDialog())),document.getElementById("optionButtons").appendChild(n);const o=document.createElement("div");o.classList.add("options-element","exportIcon","tooltip","tooltip-bottom","hand"),o.setAttribute("data-tooltip","Bildexport"),o.addEventListener("click",(()=>this.exportAsPng(this.presenter.getModelTree()))),document.getElementById("optionButtons").appendChild(o)}renderTreeAsCanvas(e,t,n,o,s,d=1){if(null===e)return s;{const i=22;switch(e.type){case"InsertNode":return this.renderTreeAsCanvas(e.followElement,t,n,o,s,d);case"Placeholder":{t.beginPath(),t.moveTo(n,s),t.lineTo(o,s),t.moveTo(n,s),t.lineTo(n,s+this.printHeight),t.moveTo(o,s),t.lineTo(o,s+this.printHeight),t.stroke(),t.beginPath();const e=n+(o-n)/2,d=s+this.printHeight/2;return t.arc(e,d,8,0,2*Math.PI),t.moveTo(e-11,d+11),t.lineTo(e+11,d-11),t.stroke(),s+this.printHeight}case"InputNode":{const a=this.printHeight*d;return t.beginPath(),t.moveTo(n,s),t.lineTo(o,s),t.moveTo(n,s),t.lineTo(n,s+a),t.moveTo(o,s),t.lineTo(o,s+a),t.stroke(),t.fillStyle="#fcedce",t.rect(n,s,o,a),t.fill(),t.fillStyle="black",t.beginPath(),t.fillText("E: "+e.text,n+15,s+i),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,s+a,d)}case"OutputNode":{const a=this.printHeight*d;return t.beginPath(),t.moveTo(n,s),t.lineTo(o,s),t.moveTo(n,s),t.lineTo(n,s+a),t.moveTo(o,s),t.lineTo(o,s+a),t.stroke(),t.fillStyle="#fcedce",t.rect(n,s,o,a),t.fill(),t.fillStyle="black",t.beginPath(),t.fillText("A: "+e.text,n+15,s+i),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,s+a,d)}case"TaskNode":{const a=this.printHeight*d;return t.beginPath(),t.moveTo(n,s),t.lineTo(o,s),t.moveTo(n,s),t.lineTo(n,s+a),t.moveTo(o,s),t.lineTo(o,s+a),t.stroke(),t.fillStyle="#fcedce",t.rect(n,s,o-n,a),t.fill(),t.fillStyle="black",t.beginPath(),t.fillText(e.text,n+15,s+i),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,s+a,d)}case"BranchNode":{t.fillStyle="rgb(250, 218, 209)",t.beginPath(),t.rect(n,s,o-n,2*this.printHeight),t.fill(),t.fillStyle="black",t.stroke(),t.beginPath(),t.moveTo(n,s),t.lineTo(n+(o-n)/2,s+2*this.printHeight),t.moveTo(o,s),t.lineTo(n+(o-n)/2,s+2*this.printHeight),t.stroke();const a=t.measureText(e.text);t.beginPath(),t.fillText(e.text,n+Math.abs(o-n-a.width)/2,s+i),t.stroke(),t.beginPath(),t.fillText("Wahr",n+15,s+this.printHeight+i),t.fillText("Falsch",o-15-t.measureText("Falsch").width,s+this.printHeight+i),t.stroke();let l,r,c=0,p=0;return this.preCountTreeDepth(e.trueChild)>this.preCountTreeDepth(e.falseChild)?(c=this.renderTreeAsCanvas(e.trueChild,t,n,n+(o-n)/2,s+2*this.printHeight,d),p=this.renderTreeAsCanvas(e.falseChild,t,n+(o-n)/2,o,s+2*this.printHeight,(this.preCountTreeDepth(e.trueChild)-this.preCountNonOneLiners(e.falseChild))/this.preCountOneLiners(e.falseChild)*d)):(c=this.renderTreeAsCanvas(e.trueChild,t,n,n+(o-n)/2,s+2*this.printHeight,(this.preCountTreeDepth(e.falseChild)-this.preCountNonOneLiners(e.trueChild))/this.preCountOneLiners(e.trueChild)*d),p=this.renderTreeAsCanvas(e.falseChild,t,n+(o-n)/2,o,s+2*this.printHeight,d)),c<p?(l=p,r=c):(l=c,r=p),t.rect(n,s,o-n,l-s),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,r,d)}case"CountLoopNode":case"HeadLoopNode":{const a=this.renderTreeAsCanvas(e.child,t,n+(o-n)/12,o,s+this.printHeight,d);return t.rect(n,s,o-n,a-s),t.stroke(),t.beginPath(),t.fillStyle="rgb(220, 239, 231)",t.rect(n,s,o,this.printHeight-1),t.rect(n,s,(o-n)/12-1,a-s),t.fill(),t.fillStyle="black",t.beginPath(),t.fillText(e.text,n+15,s+i),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,a,d)}case"FootLoopNode":{const a=this.renderTreeAsCanvas(e.child,t,n+(o-n)/12,o,s,d);return t.rect(n,s,o-n,a-s+this.printHeight),t.stroke(),t.beginPath(),t.fillStyle="rgb(220, 239, 231)",t.rect(n,s,(o-n)/12,a-s+this.printHeight),t.rect(n,a,o,this.printHeight),t.fill(),t.fillStyle="black",t.beginPath(),t.fillText(e.text,n+15,a+i),t.stroke(),t.beginPath(),t.moveTo(n+(o-n)/12,a),t.lineTo(o,a),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,a+this.printHeight,d)}case"CaseNode":{t.fillStyle="rgb(250, 218, 209)",t.beginPath(),t.rect(n,s,o-n,2*this.printHeight),t.fill(),t.fillStyle="black";let a=e.cases.length;e.defaultOn&&(a+=1);const l=(o-n)/a,r=this.printHeight/e.cases.length;if(t.stroke(),t.beginPath(),t.moveTo(n,s),e.defaultOn){t.lineTo(o-l,s+this.printHeight),t.lineTo(o,s),t.moveTo(o-l,s+this.printHeight),t.lineTo(o-l,s+2*this.printHeight),t.stroke();const n=t.measureText(e.text);t.beginPath(),t.fillText(e.text,o-l-1.3*n.width/2,s+.7*i),t.stroke()}else{t.lineTo(o,s+this.printHeight),t.stroke();const n=t.measureText(e.text);t.beginPath(),t.fillText(e.text,o-n.width,s+.7*i),t.stroke()}let c=n;const p=this.preCountTreeDepth(e)-2,h=this.getDeepestCase(e);let u=s+3*this.printHeight;for(const n of e.cases){let e;if(h===n)e=this.renderTreeAsCanvas(n,t,c,c+l,s+this.printHeight,d);else if(p===this.preCountTreeDepth(n)){const o=(this.preCountTreeDepth(n)*d-this.preCountNonOneLiners(n))/this.preCountOneLiners(n);e=this.renderTreeAsCanvas(n,t,c,c+l,s+this.printHeight,o)}else{const o=(p-this.preCountNonOneLiners(n))/this.preCountOneLiners(n)*d;e=this.renderTreeAsCanvas(n,t,c,c+l,s+this.printHeight,o)}e>u&&(u=e),c+=l}if(e.defaultOn){let n;if(h===e.defaultNode)n=this.renderTreeAsCanvas(e.defaultNode,t,c,c+l,s+this.printHeight,d);else if(p===this.preCountTreeDepth(e.defaultNode)){const o=(this.preCountTreeDepth(e.defaultNode)*d-this.preCountNonOneLiners(e.defaultNode))/this.preCountOneLiners(e.defaultNode);n=this.renderTreeAsCanvas(e.defaultNode,t,c,c+l,s+this.printHeight,o)}else{const o=(p-this.preCountNonOneLiners(e.defaultNode))/this.preCountOneLiners(e.defaultNode)*d;n=this.renderTreeAsCanvas(e.defaultNode,t,c,c+l,s+this.printHeight,o)}n>u&&(u=n)}for(let o=1;o<=e.cases.length;o++)t.beginPath(),t.moveTo(n+o*l,s+o*r),t.lineTo(n+o*l,u),t.stroke();return this.renderTreeAsCanvas(e.followElement,t,n,o,u,d)}case"InsertCase":{const a=t.measureText(e.text);return t.beginPath(),t.fillText(e.text,n+Math.abs(o-n-a.width)/2,s+i),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,s+this.printHeight,d)}case"FunctionNode":{const d=this.renderTreeAsCanvas(e.child,t,n+(o-n)/12,o,s+this.printHeight);t.rect(n,s,o-n,d-s),t.stroke(),t.beginPath(),t.fillStyle="white",t.rect(n,s,o,this.printHeight-1),t.rect(n,s,(o-n)/12-1,d-s+this.printHeight),t.rect(n,d,o,this.printHeight-2),t.fill(),t.fillStyle="black",t.beginPath();let a="";for(let t=0;t<e.parameters.length;t++)0===e.parameters.length||t===e.parameters.length-1?a+=e.parameters[t].parName:a+=e.parameters[t].parName+", ";return t.fillText("function "+e.text+"("+a+") {",n+15,s+i),t.fillText("}",n+15,d+i),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,d+this.printHeight)}case"TryCatchNode":{const a=this.renderTreeAsCanvas(e.tryChild,t,n+(o-n)/12,o,s+this.printHeight,d),l=this.renderTreeAsCanvas(e.catchChild,t,n+(o-n)/12,o,a+this.printHeight,d);return t.rect(n,s,o-n,l-s),t.stroke(),t.beginPath(),t.fillStyle="rgb(250, 218, 209)",t.rect(n,s,o,this.printHeight-1),t.rect(n,a,o,this.printHeight-1),t.rect(n,s,(o-n)/12-1,l-s),t.fill(),t.fillStyle="black",t.beginPath(),t.fillText("Try",n+15,s+i),t.fillText("Catch",n+15,a+i),t.stroke(),t.beginPath(),t.moveTo(n+(o-n)/12,a),t.lineTo(o,a),t.stroke(),this.renderTreeAsCanvas(e.followElement,t,n,o,l,d)}}}}preCountTreeDepth(e){if(null===e)return 0;switch(e.type){case"FunctionNode":case"InsertNode":case"InsertCase":return this.preCountTreeDepth(e.followElement);case"Placeholder":return 1;case"InputNode":case"OutputNode":case"TaskNode":return 1+this.preCountTreeDepth(e.followElement);case"BranchNode":{const t=this.preCountTreeDepth(e.trueChild),n=this.preCountTreeDepth(e.falseChild);return t<n?2+n:2+t}case"CountLoopNode":case"HeadLoopNode":case"FootLoopNode":return 1+this.preCountTreeDepth(e.child)+this.preCountTreeDepth(e.followElement);case"TryCatchNode":return 2+this.preCountTreeDepth(e.tryChild)+this.preCountTreeDepth(e.catchChild)+this.preCountTreeDepth(e.followElement);case"CaseNode":{const t=[];for(const n of e.cases)t.push(this.preCountTreeDepth(n));return e.defaultOn&&t.push(this.preCountTreeDepth(e.defaultNode)),2+Math.max(...t)}}}getDeepestCase(e){const t=[],n=[];for(const o of e.cases)t.push(this.preCountTreeDepth(o)),n.push(this.preCountOneLiners(o));e.defaultOn&&(t.push(this.preCountTreeDepth(e.defaultNode)),n.push(this.preCountOneLiners(e.defaultNode)));const o=Math.max(...t);for(let e=0;e<t.length;e++)t[e]===o&&(t[e]+=n[e]);const s=t.indexOf(Math.max(...t));return s===t.length-1?e.defaultNode:e.cases[s]}preCountNonOneLiners(e){if(null===e)return 0;switch(e.type){case"FunctionNode":case"InsertNode":case"InsertCase":case"InputNode":case"OutputNode":case"TaskNode":return this.preCountNonOneLiners(e.followElement);case"Placeholder":return 0;case"BranchNode":{const t=this.preCountNonOneLiners(e.trueChild),n=this.preCountNonOneLiners(e.falseChild);return t<n?2+n:2+t}case"CountLoopNode":case"HeadLoopNode":case"FootLoopNode":return 1+this.preCountNonOneLiners(e.child)+this.preCountNonOneLiners(e.followElement);case"TryCatchNode":return 2+this.preCountNonOneLiners(e.tryChild)+this.preCountNonOneLiners(e.catchChild)+this.preCountNonOneLiners(e.followElement);case"CaseNode":{const t=[];for(const n of e.cases)t.push(this.preCountNonOneLiners(n));return e.defaultOn&&t.push(this.preCountNonOneLiners(e.defaultNode)),2+this.preCountNonOneLiners(this.getDeepestCase(e))}}}preCountOneLiners(e){if(null===e)return 0;switch(e.type){case"FunctionNode":case"InsertNode":case"InsertCase":return this.preCountOneLiners(e.followElement);case"Placeholder":return 1;case"InputNode":case"OutputNode":case"TaskNode":return 1+this.preCountOneLiners(e.followElement);case"BranchNode":{const t=this.preCountOneLiners(e.trueChild),n=this.preCountOneLiners(e.falseChild);return t<n?n:t}case"CountLoopNode":case"HeadLoopNode":case"FootLoopNode":return this.preCountOneLiners(e.child)+this.preCountOneLiners(e.followElement);case"TryCatchNode":return this.preCountOneLiners(e.tryChild)+this.preCountOneLiners(e.catchChild)+this.preCountOneLiners(e.followElement);case"CaseNode":{const t=[];for(const n of e.cases)t.push(this.preCountOneLiners(n));return e.defaultOn&&t.push(this.preCountOneLiners(e.defaultNode)),Math.max(...t)}}}exportAsPng(e){const t=document.createElement("canvas"),n=t.getContext("2d"),o=document.getElementById("structogram").parentElement.parentElement.clientWidth;t.width=o,t.height=document.getElementById("structogram").clientHeight,n.font="16px sans-serif",n.lineWidth="1";const s=this.renderTreeAsCanvas(e,n,0,o,0);n.rect(0,0,o,s+1),n.strokeStyle="black",n.lineWidth=1,n.stroke();const d="struktog_"+new Date(Date.now()).toJSON().substring(0,10)+".png",i=document.createElement("a");i.setAttribute("href",t.toDataURL("image/png")),i.setAttribute("download",d),i.click()}resetButtons(){}displaySourcecode(){}setLang(){}}window.onload=function(){if("undefined"!=typeof Storage){const n=new URL(window.location.href),o=n.searchParams.get("url");null!==o&&fetch(o).then((e=>e.json())).then((e=>{console.log(e),t.readUrl(e)}));const s=n.searchParams.get("config");e.loadConfig(s)}!function(){const e=document.createElement("header");e.classList.add("container"),document.body.appendChild(e);const t=document.createElement("section");t.classList.add("nav-col"),e.appendChild(t);const n=document.createElement("div");n.classList.add("nav-logo-container"),t.appendChild(n);const o=document.createElement("a");o.classList.add("column","container");let s="index.html";const d=new URL(window.location.href);d.searchParams.get("config")&&(s=s+"?config="+d.searchParams.get("config")),o.setAttribute("href",s),n.appendChild(o);const i=document.createElement("div");i.classList.add("logo","logo-container"),o.appendChild(i);const a=document.createElement("strong");a.classList.add("nav-col"),a.appendChild(document.createTextNode("Struktog.")),o.appendChild(a);const l=document.createElement("section");l.classList.add("nav-col-opt"),e.appendChild(l);const r=document.createElement("div");r.classList.add("options-container"),r.setAttribute("id","optionButtons"),l.appendChild(r);const c=document.createElement("div");c.classList.add("divider"),document.body.appendChild(c);const p=document.createElement("main");document.body.appendChild(p);const h=document.createElement("div");h.classList.add("container"),h.setAttribute("id","editorDisplay"),p.appendChild(h);const u=document.createElement("div");u.classList.add("modal"),u.setAttribute("id","IEModal"),p.appendChild(u);const m=document.createElement("div");m.classList.add("modal-overlay"),m.setAttribute("aria-label","Close"),m.addEventListener("click",(()=>{document.getElementById("IEModal").classList.remove("active")})),u.appendChild(m);const f=document.createElement("div");f.classList.add("modal-container"),u.appendChild(f);const C=document.createElement("div");C.classList.add("modal-header"),f.appendChild(C);const E=document.createElement("div");E.classList.add("close","hand","cancelIcon"),E.addEventListener("click",(()=>{document.getElementById("IEModal").classList.remove("active")})),C.appendChild(E);const g=document.createElement("div");g.classList.add("modal-body"),f.appendChild(g);const L=document.createElement("div");L.classList.add("content"),L.setAttribute("id","modal-content"),g.appendChild(L);const N=document.createElement("div");N.classList.add("modal-footer","container"),N.setAttribute("id","modal-footer"),f.appendChild(N)}(),function(){const e=document.createElement("footer");e.classList.add("container"),document.body.appendChild(e);const t=document.createElement("div");t.classList.add("column"),e.appendChild(t);const n=document.createElement("span");if("dev"===new URL(window.location.href).pathname.split("/")[1]){const e=document.createTextNode("Development branch please use ");n.appendChild(e);const t=document.createElement("a");t.appendChild(document.createTextNode("stable version")),t.setAttribute("href","https://dditools.inf.tu-dresden.de/struktog/"),n.appendChild(t),n.appendChild(document.createTextNode(" | "))}const o=document.createElement("div");o.classList.add("hand"),o.appendChild(document.createTextNode("Source code")),o.setAttribute("href","https://gitlab.com/ddi-tu-dresden/cs-school-tools/struktog"),o.setAttribute("data-tooltip","Gitlab Repository"),o.addEventListener("click",(()=>{window.open("https://gitlab.com/ddi-tu-dresden/cs-school-tools/struktog","_blank")}));const s=document.createElement("div");s.appendChild(document.createTextNode("Didaktik der Informatik der TU Dresden"));const d=document.createElement("div");d.appendChild(document.createTextNode("v1.3.0")),t.appendChild(n),n.appendChild(o),n.appendChild(document.createTextNode("|")),n.appendChild(s),n.appendChild(document.createTextNode("|")),n.appendChild(d)}();const t=new s(o);o.setPresenter(t);const n=new i(t,document.getElementById("editorDisplay"));t.addView(n);const d=new a(t,document.getElementById("editorDisplay"));t.addView(d);const r=new l(t,document.getElementById("Export"));t.addView(r),t.init()}})()})();